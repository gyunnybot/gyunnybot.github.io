---
layout: single
title:  "Thread.interrupted(), Thread.sleep() 인터럽트 처리"
folder: "java"
categories:
  - java
permalink: categories/java/java005
tags: JAVA
toc: true
toc_sticky: true
sidebar_main: true
published: true
---

## Thread.sleep() 메서드와 예외 처리
<span style="color: rgb(3, 150, 150); font-weight: bold;">`Thread.sleep()`</span>은 항상 <span style="color: rgb(3, 150, 150); font-weight: bold;">`InterruptedException`</span>을 발생시킬 **가능성이 있는 메서드로 간주**되기 때문에 인터럽트의 상태가 초기화되었는지와는 관계없이 반드시 <span style="color: rgb(3, 150, 150); font-weight: bold;">`try-catch`</span>문을 사용하거나 <span style="color: rgb(3, 150, 150); font-weight: bold;">`throws`</span>로 예외를 처리해야 합니다. 이 규칙은 컴파일 타임에 강제됩니다.

## 왜 반드시 예외 처리가 필요한가?
<span style="color: rgb(3, 150, 150); font-weight: bold;">`InterruptedException`</span>은 **체크 예외**이기 때문입니다. 자바의 체크 예외는 컴파일러에서 반드시 처리하도록 요구합니다. Thread.sleep()은 InterruptedException을 던질 가능성이 있는 메서드이므로, try-catch 블록으로 예외를 처리하거나, 호출한 메서드의 시그니처에 throws InterruptedException을 선언해야 합니다.

한편 Thread.sleep()은 인터럽트 상태와 관계없이 Thread.sleep() 자체로도 예외를 발생시킬 수 있습니다. 현재 스레드의 interrupt 상태가 false라면 Thread.sleep()은 정상적으로 실행됩니다. 하지만 스레드가 실행 중에 다른 스레드에서 interrupt를 발생시키면, 즉시 InterruptedException을 던집니다. 따라서 Thread.sleep()은 반드시 예외 처리가 필요합니다.


## 핵심 요약
**Thread.sleep()은 호출 시 interrupt 상태에 따라 동작이 달라집니다:**
   - interrupt 상태가 true라면: 즉시 InterruptedException이 발생합니다.
   - interrupt 상태가 false라면: 정상적으로 지정된 시간 동안 대기합니다.
   - 그러나 sleep 중에 interrupt가 발생하면 언제든 예외를 던질 수 있습니다.

**Thread.interrupted()로 interrupt 상태를 초기화하면:**
   - 현재 interrupt 상태가 false로 변경됩니다.
   - 이 상태에서 Thread.sleep()을 호출해도 바로 InterruptedException이 발생하지 않습니다.
   - 하지만 다른 스레드에서 interrupt를 호출하면 예외가 발생할 수 있습니다.

**예외 처리 규칙:**
   - Thread.sleep()은 항상 try-catch로 예외를 처리하거나 throws InterruptedException으로 호출자에게 예외 처리를 위임해야 합니다.

```java
public class SleepExample {
    public static void main(String[] args) {
        Thread worker = new Thread(() -> {
            try {
                // interrupt 상태 초기화
                Thread.interrupted(); // interrupt 상태를 false로 변경
                System.out.println("Interrupt status cleared.");

                // sleep 호출
                Thread.sleep(5000); // 예외가 발생할 가능성 있음
                System.out.println("Slept successfully without interruption.");
            } catch (InterruptedException e) {
                System.out.println("Interrupted during sleep!");
            }
        });

        worker.start();

        try {
            Thread.sleep(1000); // 메인 스레드 대기
            worker.interrupt(); // worker 스레드 interrupt
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

```bash
Interrupt status cleared.
Interrupted during sleep!
```

## 정리
Thread.sleep()은 InterruptedException을 발생시킬 가능성이 있는 메서드로 반드시 예외 처리가 필요합니다.

Thread.interrupted()를 호출해 interrupt 상태를 초기화하더라도, sleep() 중에 interrupt가 발생할 수 있으므로 예외 처리 코드는 항상 준비해야 합니다.